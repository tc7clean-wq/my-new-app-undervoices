import{u as M,a as P,b as $,j as e,L as A}from"./index-Dc-RHZ8Q.js";import{j as E,d as o,L as g}from"./vendor-DZhegkiK.js";import{u as W}from"./useVoiceHints-BWE_yW86.js";import"./api-ngrFHoWO.js";import"./crypto-DhyMKz0y.js";const _=()=>{const[v,u]=E(),[s,k]=o.useState(v.get("q")||""),[a,w]=o.useState({articles:[],storyboards:[],profiles:[]}),[p,y]=o.useState(!1),[l,d]=o.useState("all"),[n,c]=o.useState({category:"all",sortBy:"relevance",dateRange:"all",tags:[]}),{get:x}=M(),{showNotification:N,userPreferences:h}=P(),{announceHints:f}=W();o.useEffect(()=>{h.enableVoiceHints&&h.showTutorials&&setTimeout(()=>{f("search")},2e3)},[f,h]),o.useEffect(()=>{s.trim()&&m()},[s]),o.useEffect(()=>{s.trim()&&m()},[n]);const m=async()=>{if(s.trim())try{y(!0);const r={q:s,...n},[t,i,B]=await Promise.all([x(`/search/articles?${new URLSearchParams(r)}`),x(`/search/storyboards?${new URLSearchParams(r)}`),x(`/search/profiles?${new URLSearchParams(r)}`)]);w({articles:t.articles||[],storyboards:i.storyboards||[],profiles:B.profiles||[]})}catch(r){N({type:"error",title:"Search Failed",message:r.message||"Unable to perform search"})}finally{y(!1)}},S=r=>{r.preventDefault(),s.trim()&&(u({q:s.trim()}),m())},L=r=>{k(r),u({q:r.trim()})},{bindGestures:C}=$({onSwipeLeft:()=>{const r=["all","articles","storyboards","profiles"],i=(r.indexOf(l)+1)%r.length;d(r[i])},onSwipeRight:()=>{const r=["all","articles","storyboards","profiles"],i=(r.indexOf(l)-1+r.length)%r.length;d(r[i])}}),j=()=>a.articles.length+a.storyboards.length+a.profiles.length,b=r=>{switch(r){case"articles":return a.articles;case"storyboards":return a.storyboards;case"profiles":return a.profiles;default:return[...a.articles,...a.storyboards,...a.profiles]}},R=({article:r})=>e.jsx(g,{to:`/article/${r.id}`,className:"block bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 overflow-hidden border border-gray-200 dark:border-gray-700 hover:border-primary-300 dark:hover:border-primary-600 group",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors duration-200 line-clamp-2",children:r.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 line-clamp-3",children:r.summary})]}),r.verification_status==="verified"&&e.jsx("div",{className:"ml-3 text-green-500",title:"Verified article",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),r.view_count||0]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),r.share_count||0]})]}),e.jsx("span",{children:new Date(r.published_at||r.created_at).toLocaleDateString()})]}),r.tags&&r.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-3",children:[r.tags.slice(0,3).map((t,i)=>e.jsxs("span",{className:"px-2 py-1 text-xs bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 rounded-md",children:["#",t]},i)),r.tags.length>3&&e.jsxs("span",{className:"px-2 py-1 text-xs text-gray-500 dark:text-gray-400",children:["+",r.tags.length-3," more"]})]})]})}),z=({storyboard:r})=>e.jsx(g,{to:`/storyboard/${r.id}`,className:"block bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 overflow-hidden border border-gray-200 dark:border-gray-700 hover:border-primary-300 dark:hover:border-primary-600 group",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors duration-200",children:r.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:r.description})]}),e.jsx("div",{className:"ml-3 text-primary-500",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:["Nodes: ",r.nodes?.length||0]}),e.jsxs("span",{children:["Connections: ",r.edges?.length||0]})]}),e.jsx("span",{children:new Date(r.updated_at).toLocaleDateString()})]})]})}),T=({profile:r})=>e.jsx(g,{to:`/profile/${r.username}`,className:"block bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 overflow-hidden border border-gray-200 dark:border-gray-700 hover:border-primary-300 dark:hover:border-primary-600 group",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-500 rounded-full flex items-center justify-center text-white font-medium text-lg mr-4",children:r.displayName[0].toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors duration-200",children:r.displayName}),r.isVerified&&e.jsx("svg",{className:"w-4 h-4 ml-1 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["@",r.username]})]})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:r.bio})]})});return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-6",children:"Search Underground Voices"}),e.jsx("form",{onSubmit:S,className:"max-w-2xl",children:e.jsxs("div",{className:"flex bg-white dark:bg-gray-700 rounded-lg overflow-hidden shadow-sm border border-gray-200 dark:border-gray-600",children:[e.jsx("input",{type:"text",value:s,onChange:r=>L(r.target.value),placeholder:"Search for articles, storyboards, journalists...",className:"flex-1 px-6 py-4 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none bg-transparent","aria-label":"Search query"}),e.jsx("button",{type:"submit",className:"px-6 py-4 bg-primary-600 hover:bg-primary-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2","aria-label":"Submit search",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-4",children:[e.jsxs("select",{value:n.category,onChange:r=>c(t=>({...t,category:r.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"politics",children:"Politics"}),e.jsx("option",{value:"environment",children:"Environment"}),e.jsx("option",{value:"technology",children:"Technology"}),e.jsx("option",{value:"health",children:"Health"}),e.jsx("option",{value:"economy",children:"Economy"})]}),e.jsxs("select",{value:n.sortBy,onChange:r=>c(t=>({...t,sortBy:r.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"relevance",children:"Relevance"}),e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"views",children:"Views"}),e.jsx("option",{value:"shares",children:"Shares"})]}),e.jsxs("select",{value:n.dateRange,onChange:r=>c(t=>({...t,dateRange:r.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"day",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"}),e.jsx("option",{value:"year",children:"This Year"})]})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s&&e.jsx("div",{className:"mb-6",children:e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Found ",j(),' results for "',s,'"']})}),s&&e.jsx("div",{className:"mb-8",...C(),children:e.jsx("div",{className:"flex space-x-1 bg-white dark:bg-gray-800 p-1 rounded-lg shadow-sm",children:[{id:"all",label:"All",count:j()},{id:"articles",label:"Articles",count:a.articles.length},{id:"storyboards",label:"Storyboards",count:a.storyboards.length},{id:"profiles",label:"Journalists",count:a.profiles.length}].map(r=>e.jsxs("button",{onClick:()=>d(r.id),className:`flex-1 flex items-center justify-center space-x-2 px-4 py-3 rounded-md font-medium text-sm transition-all duration-200 ${l===r.id?"bg-primary-600 text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[e.jsx("span",{children:r.label}),e.jsxs("span",{className:"text-xs opacity-75",children:["(",r.count,")"]})]},r.id))})}),p&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(A,{size:"large",text:"Searching..."})}),!p&&s&&e.jsx("div",{className:"animate-fade-in",children:b(l).length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No results found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Try adjusting your search terms or filters"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b(l).map((r,t)=>l==="articles"||l==="all"&&r.title&&r.summary?e.jsx(R,{article:r},`article-${r.id}`):l==="storyboards"||l==="all"&&r.nodes?e.jsx(z,{storyboard:r},`storyboard-${r.id}`):l==="profiles"||l==="all"&&r.username?e.jsx(T,{profile:r},`profile-${r.id}`):null)})}),!s&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Start your search"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Enter a search term to find articles, storyboards, and journalists"})]})]})]})};export{_ as default};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-MP8PpCB4.js","assets/vendor-DZhegkiK.js","assets/useVoiceHints-BWE_yW86.js","assets/api-ngrFHoWO.js","assets/crypto-DhyMKz0y.js","assets/Dashboard-z0ZuedNL.js","assets/Login-Bx4Wb436.js","assets/Register-Ce5g9_Q7.js","assets/ArticleEditor-CjOdjdAY.js","assets/ArticleView-NeVrQqMQ.js","assets/StoryboardEditor-DgI8Zv33.js","assets/StoryboardCanvas-DkCa5LDl.js","assets/StoryboardView-CwGzRj_i.js","assets/Profile-CgQrHs1-.js","assets/Settings-BiHsQr2e.js","assets/Search-Dd4jF2qq.js"])))=>i.map(i=>d[i]);
import{r as pe,a as xe,b as ie,d as a,R as ce,u as Se,e as Ee,L as P,B as be,f as ke,h as w,N as ve}from"./vendor-DZhegkiK.js";import{a as le}from"./api-ngrFHoWO.js";import{r as Te}from"./crypto-DhyMKz0y.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))u(m);new MutationObserver(m=>{for(const f of m)if(f.type==="childList")for(const l of f.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&u(l)}).observe(document,{childList:!0,subtree:!0});function s(m){const f={};return m.integrity&&(f.integrity=m.integrity),m.referrerPolicy&&(f.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?f.credentials="include":m.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function u(m){if(m.ep)return;m.ep=!0;const f=s(m);fetch(m.href,f)}})();var H={exports:{}},U={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ee;function we(){if(ee)return U;ee=1;var r=pe(),t=Symbol.for("react.element"),s=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,m=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,f={key:!0,ref:!0,__self:!0,__source:!0};function l(g,y,p){var h,d={},n=null,o=null;p!==void 0&&(n=""+p),y.key!==void 0&&(n=""+y.key),y.ref!==void 0&&(o=y.ref);for(h in y)u.call(y,h)&&!f.hasOwnProperty(h)&&(d[h]=y[h]);if(g&&g.defaultProps)for(h in y=g.defaultProps,y)d[h]===void 0&&(d[h]=y[h]);return{$$typeof:t,type:g,key:n,ref:o,props:d,_owner:m.current}}return U.Fragment=s,U.jsx=l,U.jsxs=l,U}var re;function _e(){return re||(re=1,H.exports=we()),H.exports}var e=_e(),G={},te;function Ne(){if(te)return G;te=1;var r=xe();return G.createRoot=r.createRoot,G.hydrateRoot=r.hydrateRoot,G}var je=Ne();const Re=ie(je),Ae="modulepreload",Ce=function(r){return"/"+r},se={},N=function(t,s,u){let m=Promise.resolve();if(s&&s.length>0){let y=function(p){return Promise.all(p.map(h=>Promise.resolve(h).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),g=l?.nonce||l?.getAttribute("nonce");m=y(s.map(p=>{if(p=Ce(p),p in se)return;se[p]=!0;const h=p.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${d}`))return;const n=document.createElement("link");if(n.rel=h?"stylesheet":Ae,h||(n.as="script"),n.crossOrigin="",n.href=p,g&&n.setAttribute("nonce",g),document.head.appendChild(n),h)return new Promise((o,c)=>{n.addEventListener("load",o),n.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${p}`)))})}))}function f(l){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=l,window.dispatchEvent(g),!g.defaultPrevented)throw l}return m.then(l=>{for(const g of l||[])g.status==="rejected"&&f(g.reason);return t().catch(f)})};var Ie=Te();const Y=ie(Ie),de="/api",oe="default-key-change-in-production",z=le.create({baseURL:de,timeout:1e4,headers:{"Content-Type":"application/json","X-Client-Version":"1.0.0","X-Device-Type":/Mobi|Android/i.test(navigator.userAgent)?"mobile":"desktop"}});z.interceptors.request.use(r=>{const t=localStorage.getItem("accessToken");return t&&(r.headers.Authorization=`Bearer ${t}`),r},r=>Promise.reject(r));z.interceptors.response.use(r=>r,async r=>{const t=r.config;if(r.response?.status===401&&!t._retry){t._retry=!0;try{const s=localStorage.getItem("refreshToken");if(s){const u=await le.post(`${de}/auth/refresh`,{refreshToken:s}),{accessToken:m,refreshToken:f}=u.data;return localStorage.setItem("accessToken",m),localStorage.setItem("refreshToken",f),t.headers.Authorization=`Bearer ${m}`,z(t)}}catch(s){return localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/login",Promise.reject(s)}}return Promise.reject(r)});const Oe=()=>{const[r,t]=a.useState(!1),[s,u]=a.useState(null),m=a.useCallback(n=>{try{return Y.AES.encrypt(JSON.stringify(n),oe).toString()}catch(o){return console.error("Encryption error:",o),n}},[]),f=a.useCallback(n=>{try{const o=Y.AES.decrypt(n,oe);return JSON.parse(o.toString(Y.enc.Utf8))}catch(o){return console.error("Decryption error:",o),n}},[]),l=a.useCallback(async(n,o={})=>{t(!0),u(null);try{const c={url:n,method:o.method||"GET",...o};o.encrypt&&c.data&&(c.data=m(c.data));let E=(await z(c)).data;return o.decrypt&&E&&(E=f(E)),E}catch(c){const j=c.response?.data?.message||c.message||"An error occurred",E=c.response?.status||500,R={message:j,code:E,details:c.response?.data?.details||null};throw u(R),R}finally{t(!1)}},[m,f]),g=a.useCallback((n,o={})=>l(n,{...o,method:"GET"}),[l]),y=a.useCallback((n,o,c={})=>l(n,{...c,method:"POST",data:o}),[l]),p=a.useCallback((n,o,c={})=>l(n,{...c,method:"PUT",data:o}),[l]),h=a.useCallback((n,o={})=>l(n,{...o,method:"DELETE"}),[l]),d=a.useCallback((n,o,c={})=>l(n,{...c,method:"PATCH",data:o}),[l]);return{loading:r,error:s,request:l,get:g,post:y,put:p,delete:h,patch:d,encryptData:m,decryptData:f}},ue=a.createContext(),Pe={user:null,isAuthenticated:!1,loading:!0,error:null},De=(r,t)=>{switch(t.type){case"AUTH_START":return{...r,loading:!0,error:null};case"AUTH_SUCCESS":return{...r,user:t.payload.user,isAuthenticated:!0,loading:!1,error:null};case"AUTH_FAILURE":return{...r,user:null,isAuthenticated:!1,loading:!1,error:t.payload};case"AUTH_LOGOUT":return{...r,user:null,isAuthenticated:!1,loading:!1,error:null};case"UPDATE_USER":return{...r,user:{...r.user,...t.payload}};default:return r}},Le=({children:r})=>{const[t,s]=a.useReducer(De,Pe),{request:u}=Oe();a.useEffect(()=>{m()},[]);const m=async()=>{const n=localStorage.getItem("accessToken");if(!n){s({type:"AUTH_FAILURE",payload:"No token found"});return}try{const o=await u("/auth/me",{method:"GET",headers:{Authorization:`Bearer ${n}`}});if(o.success)s({type:"AUTH_SUCCESS",payload:{user:o.user}});else throw new Error("Invalid token")}catch(o){localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),s({type:"AUTH_FAILURE",payload:o.message})}},d={...t,login:async(n,o=!1)=>{s({type:"AUTH_START"});try{const c=await u("/auth/login",{method:"POST",body:JSON.stringify({...n,rememberMe:o})});if(c.success)return localStorage.setItem("accessToken",c.accessToken),localStorage.setItem("refreshToken",c.refreshToken),s({type:"AUTH_SUCCESS",payload:{user:c.user}}),{success:!0};throw new Error(c.message||"Login failed")}catch(c){return s({type:"AUTH_FAILURE",payload:c.message}),{success:!1,error:c.message}}},register:async n=>{s({type:"AUTH_START"});try{const o=await u("/auth/register",{method:"POST",body:JSON.stringify(n)});if(o.success)return localStorage.setItem("accessToken",o.accessToken),localStorage.setItem("refreshToken",o.refreshToken),s({type:"AUTH_SUCCESS",payload:{user:o.user}}),{success:!0};throw new Error(o.message||"Registration failed")}catch(o){return s({type:"AUTH_FAILURE",payload:o.message}),{success:!1,error:o.message}}},logout:async()=>{try{const n=localStorage.getItem("accessToken");n&&await u("/auth/logout",{method:"POST",headers:{Authorization:`Bearer ${n}`}})}catch(n){console.error("Logout error:",n)}finally{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),s({type:"AUTH_LOGOUT"})}},updateProfile:async n=>{try{const o=localStorage.getItem("accessToken"),c=await u(`/profiles/${t.user.id}`,{method:"PUT",headers:{Authorization:`Bearer ${o}`},body:JSON.stringify(n)});if(c.success)return s({type:"UPDATE_USER",payload:c.profile}),{success:!0};throw new Error(c.message||"Profile update failed")}catch(o){return{success:!1,error:o.message}}},toggleAnonymousMode:async()=>{try{const n=localStorage.getItem("accessToken"),o=await u(`/profiles/${t.user.id}/toggle-anonymous`,{method:"POST",headers:{Authorization:`Bearer ${n}`}});if(o.success)return s({type:"UPDATE_USER",payload:{isAnonymous:o.isAnonymous}}),{success:!0,isAnonymous:o.isAnonymous};throw new Error(o.message||"Failed to toggle anonymous mode")}catch(n){return{success:!1,error:n.message}}},refreshToken:async()=>{const n=localStorage.getItem("refreshToken");if(!n)throw new Error("No refresh token available");try{const o=await u("/auth/refresh",{method:"POST",body:JSON.stringify({refreshToken:n})});if(o.success)return localStorage.setItem("accessToken",o.accessToken),localStorage.setItem("refreshToken",o.refreshToken),o.accessToken;throw new Error("Token refresh failed")}catch(o){throw localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),s({type:"AUTH_LOGOUT"}),o}},checkAuthStatus:m};return e.jsx(ue.Provider,{value:d,children:r})},Me=()=>{const r=a.useContext(ue);if(!r)throw new Error("useAuth must be used within an AuthProvider");return r},me=a.createContext(),V={theme:"system",isDark:!1,sidebarOpen:!1,notifications:[],loading:!1,error:null,searchQuery:"",filters:{category:"all",tags:[],sortBy:"created_at",sortOrder:"desc"},userPreferences:{language:"en",autoSave:!0,showTutorials:!0,enableVoiceHints:!1,highContrast:!1,reducedMotion:!1}},Ue=(r,t)=>{switch(t.type){case"SET_THEME":return{...r,theme:t.payload};case"TOGGLE_DARK_MODE":return{...r,isDark:!r.isDark};case"SET_DARK_MODE":return{...r,isDark:t.payload};case"TOGGLE_SIDEBAR":return{...r,sidebarOpen:!r.sidebarOpen};case"SET_SIDEBAR":return{...r,sidebarOpen:t.payload};case"ADD_NOTIFICATION":return{...r,notifications:[...r.notifications,t.payload]};case"REMOVE_NOTIFICATION":return{...r,notifications:r.notifications.filter(s=>s.id!==t.payload)};case"CLEAR_NOTIFICATIONS":return{...r,notifications:[]};case"SET_LOADING":return{...r,loading:t.payload};case"SET_ERROR":return{...r,error:t.payload};case"CLEAR_ERROR":return{...r,error:null};case"SET_SEARCH_QUERY":return{...r,searchQuery:t.payload};case"SET_FILTERS":return{...r,filters:{...r.filters,...t.payload}};case"RESET_FILTERS":return{...r,filters:V.filters};case"UPDATE_PREFERENCES":return{...r,userPreferences:{...r.userPreferences,...t.payload}};case"RESET_PREFERENCES":return{...r,userPreferences:V.userPreferences};default:return r}},$e=({children:r})=>{const[t,s]=a.useReducer(Ue,V);a.useEffect(()=>{const i=localStorage.getItem("theme"),x=localStorage.getItem("userPreferences");if(i)u(i);else{const T=window.matchMedia("(prefers-color-scheme: dark)").matches;f(T)}if(x)try{const T=JSON.parse(x);s({type:"UPDATE_PREFERENCES",payload:T})}catch(T){console.error("Error parsing saved preferences:",T)}window.matchMedia("(prefers-reduced-motion: reduce)").matches&&s({type:"UPDATE_PREFERENCES",payload:{reducedMotion:!0}}),window.matchMedia("(prefers-contrast: high)").matches&&s({type:"UPDATE_PREFERENCES",payload:{highContrast:!0}})},[]),a.useEffect(()=>{t.theme!=="system"?localStorage.setItem("theme",t.theme):localStorage.removeItem("theme");const i=t.theme==="dark"||t.theme==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches;i?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),s({type:"SET_DARK_MODE",payload:i})},[t.theme]),a.useEffect(()=>{localStorage.setItem("userPreferences",JSON.stringify(t.userPreferences))},[t.userPreferences]),a.useEffect(()=>{const i=window.matchMedia("(prefers-color-scheme: dark)"),x=v=>{t.theme==="system"&&s({type:"SET_DARK_MODE",payload:v.matches})};return i.addEventListener("change",x),()=>i.removeEventListener("change",x)},[t.theme]);const u=i=>{s({type:"SET_THEME",payload:i})},m=()=>{const i=t.isDark?"light":"dark";u(i)},f=i=>{s({type:"SET_DARK_MODE",payload:i})},l=()=>{s({type:"TOGGLE_SIDEBAR"})},g=i=>{s({type:"SET_SIDEBAR",payload:i})},y=i=>{const x=Date.now()+Math.random(),v={id:x,type:"info",duration:5e3,...i};return s({type:"ADD_NOTIFICATION",payload:v}),v.duration>0&&setTimeout(()=>{p(x)},v.duration),x},p=i=>{s({type:"REMOVE_NOTIFICATION",payload:i})},b={...t,setTheme:u,toggleDarkMode:m,setDarkMode:f,toggleSidebar:l,setSidebar:g,showNotification:y,dismissNotification:p,clearNotifications:()=>{s({type:"CLEAR_NOTIFICATIONS"})},setLoading:i=>{s({type:"SET_LOADING",payload:i})},setError:i=>{s({type:"SET_ERROR",payload:i}),i&&y({type:"error",title:"Error",message:typeof i=="string"?i:i.message,duration:7e3})},clearError:()=>{s({type:"CLEAR_ERROR"})},setSearchQuery:i=>{s({type:"SET_SEARCH_QUERY",payload:i})},setFilters:i=>{s({type:"SET_FILTERS",payload:i})},resetFilters:()=>{s({type:"RESET_FILTERS"})},updatePreferences:i=>{s({type:"UPDATE_PREFERENCES",payload:i})},resetPreferences:()=>{s({type:"RESET_PREFERENCES"})},announceToScreenReader:i=>{const x=document.createElement("div");x.setAttribute("aria-live","polite"),x.setAttribute("aria-atomic","true"),x.className="sr-only",x.textContent=i,document.body.appendChild(x),setTimeout(()=>{document.body.removeChild(x)},1e3)},playNotificationSound:()=>{if(t.userPreferences.enableSounds){const i=new(window.AudioContext||window.webkitAudioContext),x=i.createOscillator(),v=i.createGain();x.connect(v),v.connect(i.destination),x.frequency.setValueAtTime(800,i.currentTime),x.frequency.setValueAtTime(600,i.currentTime+.1),v.gain.setValueAtTime(.1,i.currentTime),v.gain.exponentialRampToValueAtTime(.01,i.currentTime+.2),x.start(i.currentTime),x.stop(i.currentTime+.2)}}};return e.jsx(me.Provider,{value:b,children:r})},q=()=>{const r=a.useContext(me);if(!r)throw new Error("useApp must be used within an AppProvider");return r},he=a.createContext(),Fe={isOnline:navigator.onLine,pendingSyncs:[],lastSync:null,syncInProgress:!1},Ge=(r,t)=>{switch(t.type){case"SET_ONLINE_STATUS":return{...r,isOnline:t.payload};case"ADD_PENDING_SYNC":return{...r,pendingSyncs:[...r.pendingSyncs,t.payload]};case"REMOVE_PENDING_SYNC":return{...r,pendingSyncs:r.pendingSyncs.filter(s=>s.id!==t.payload)};case"CLEAR_PENDING_SYNCS":return{...r,pendingSyncs:[]};case"SET_SYNC_IN_PROGRESS":return{...r,syncInProgress:t.payload};case"SET_LAST_SYNC":return{...r,lastSync:t.payload};default:return r}},ze=({children:r})=>{const[t,s]=a.useReducer(Ge,Fe),{showNotification:u}=q();a.useEffect(()=>{const h=()=>{s({type:"SET_ONLINE_STATUS",payload:!0}),u({type:"success",title:"Back Online",message:"Connection restored. Syncing pending changes...",duration:3e3}),g()},d=()=>{s({type:"SET_ONLINE_STATUS",payload:!1}),u({type:"warning",title:"Offline Mode",message:"Working offline. Changes will sync when connection returns.",duration:5e3})};return window.addEventListener("online",h),window.addEventListener("offline",d),()=>{window.removeEventListener("online",h),window.removeEventListener("offline",d)}},[]),a.useEffect(()=>{const h=localStorage.getItem("pendingSyncs");if(h)try{JSON.parse(h).forEach(o=>{s({type:"ADD_PENDING_SYNC",payload:o})})}catch(n){console.error("Error loading pending syncs:",n),localStorage.removeItem("pendingSyncs")}const d=localStorage.getItem("lastSync");d&&s({type:"SET_LAST_SYNC",payload:new Date(d)})},[]),a.useEffect(()=>{localStorage.setItem("pendingSyncs",JSON.stringify(t.pendingSyncs))},[t.pendingSyncs]);const m=(h,d,n={})=>{const o={id:Date.now()+Math.random(),type:h,action:n.action||"create",data:d,timestamp:new Date().toISOString(),retries:0,maxRetries:n.maxRetries||3};s({type:"ADD_PENDING_SYNC",payload:o});const c=`offline_${h}_${o.id}`;return localStorage.setItem(c,JSON.stringify(o)),u({type:"info",title:"Saved Offline",message:`${h} saved locally and will sync when online.`,duration:3e3}),o.id},f=(h,d)=>{const n=d?`offline_${h}_${d}`:`offline_${h}`,o=localStorage.getItem(n);if(o)try{return JSON.parse(o)}catch(c){console.error("Error loading offline data:",c),localStorage.removeItem(n)}return null},l=(h,d)=>{const n=`offline_${h}_${d}`;localStorage.removeItem(n)},g=async()=>{if(t.syncInProgress||t.pendingSyncs.length===0)return;s({type:"SET_SYNC_IN_PROGRESS",payload:!0});const h=[];for(const d of t.pendingSyncs)try{await d(d),s({type:"REMOVE_PENDING_SYNC",payload:d.id}),l(d.type,d.id)}catch(n){console.error("Sync failed:",n),d.retries++,d.retries>=d.maxRetries&&(h.push(d),s({type:"REMOVE_PENDING_SYNC",payload:d.id}))}s({type:"SET_SYNC_IN_PROGRESS",payload:!1}),s({type:"SET_LAST_SYNC",payload:new Date}),localStorage.setItem("lastSync",new Date().toISOString()),h.length>0?u({type:"error",title:"Sync Failed",message:`${h.length} items failed to sync after multiple attempts.`,duration:7e3}):t.pendingSyncs.length>0&&u({type:"success",title:"Sync Complete",message:"All offline changes have been synced successfully.",duration:3e3})},p={...t,saveOffline:m,loadOffline:f,removeOffline:l,syncPendingData:g,clearAllOfflineData:()=>{s({type:"CLEAR_PENDING_SYNCS"}),Object.keys(localStorage).forEach(d=>{d.startsWith("offline_")&&localStorage.removeItem(d)}),u({type:"info",title:"Offline Data Cleared",message:"All offline data has been cleared.",duration:3e3})}};return e.jsx(he.Provider,{value:p,children:r})},Be=()=>{const r=a.useContext(he);if(!r)throw new Error("useOffline must be used within an OfflineProvider");return r};class He extends ce.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,s){this.setState({error:t,errorInfo:s})}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-md w-full p-6 text-center",children:[e.jsx("div",{className:"text-6xl mb-6",role:"img","aria-label":"Error",children:"âš ï¸"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"We encountered an unexpected error. Don't worry, your data is safe."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:"Reload Page"}),e.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null,errorInfo:null}),className:"w-full bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Try Again"})]}),!1,e.jsx("p",{className:"mt-6 text-sm text-gray-500 dark:text-gray-400",children:"If this problem persists, please contact support or try refreshing your browser."})]})}):this.props.children}}const Ye=({size:r="medium",color:t="primary",className:s="",text:u=null,fullScreen:m=!1})=>{const f={small:"w-4 h-4",medium:"w-8 h-8",large:"w-12 h-12",xl:"w-16 h-16"},l={primary:"border-primary-500",white:"border-white",gray:"border-gray-500"},g=e.jsx("div",{className:`
        inline-block animate-spin rounded-full border-2 border-solid border-current border-r-transparent
        ${f[r]} ${l[t]} ${s}
      `,role:"status","aria-label":u||"Loading",children:e.jsx("span",{className:"sr-only",children:u||"Loading..."})});return m?e.jsx("div",{className:"fixed inset-0 bg-white dark:bg-gray-900 bg-opacity-75 dark:bg-opacity-75 flex items-center justify-center z-50",children:e.jsxs("div",{className:"text-center",children:[g,u&&e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:u})]})}):e.jsxs("div",{className:"flex items-center justify-center",children:[g,u&&e.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:u})]})},Ve=(r={})=>{const{onSwipeLeft:t,onSwipeRight:s,onSwipeUp:u,onSwipeDown:m,onPinchStart:f,onPinchMove:l,onPinchEnd:g,onTap:y,onDoubleTap:p,onLongPress:h,threshold:d=50,velocityThreshold:n=.3,longPressDelay:o=500}=r,[c,j]=a.useState(null),[E,R]=a.useState(null),[$,C]=a.useState(!1),[k,b]=a.useState(!1),[i,x]=a.useState(0),[v,B]=a.useState(0),T=a.useRef(null),L=a.useRef(null),J=a.useRef(null),F=a.useCallback((_,S)=>Math.sqrt(Math.pow(S.clientX-_.clientX,2)+Math.pow(S.clientY-_.clientY,2)),[]),W=a.useCallback(_=>{const S=_.touches[0];if(j({x:S.clientX,y:S.clientY}),R(null),C(!0),J.current=Date.now(),_.touches.length===2){const A=F(_.touches[0],_.touches[1]);x(A),b(!0),f?.(A)}else T.current=setTimeout(()=>{h?.(S),C(!1)},o)},[F,f,h,o]),Q=a.useCallback(_=>{if(_.touches.length===2&&k){const S=F(_.touches[0],_.touches[1]),A=S/i;l?.(A,S),x(S)}else{const S=_.touches[0];R({x:S.clientX,y:S.clientY}),T.current&&c&&Math.sqrt(Math.pow(S.clientX-c.x,2)+Math.pow(S.clientY-c.y,2))>10&&(clearTimeout(T.current),T.current=null)}},[k,i,F,l,c]),X=a.useCallback(_=>{const S=Date.now(),A=S-(J.current||S);if(T.current&&(clearTimeout(T.current),T.current=null),k){b(!1),g?.();return}if(C(!1),!c||!E){A<300&&(B(ye=>ye+1),L.current&&clearTimeout(L.current),L.current=setTimeout(()=>{v===0?y?.(c):v===1&&p?.(c),B(0)},300));return}const I=E.x-c.x,O=E.y-c.y,K=Math.abs(I),Z=Math.abs(O),M=Math.sqrt(I*I+O*O)/A;Math.max(K,Z)<d||M<n||(K>Z?I>0?s?.(I,M):t?.(Math.abs(I),M):O>0?m?.(O,M):u?.(Math.abs(O),M))},[c,E,k,d,n,v,t,s,u,m,g,y,p]),ge=a.useCallback(()=>({onTouchStart:W,onTouchMove:Q,onTouchEnd:X,style:{touchAction:"none"}}),[W,Q,X]);return a.useEffect(()=>()=>{T.current&&clearTimeout(T.current),L.current&&clearTimeout(L.current)},[]),{bindGestures:ge,isPressed:$,isPinching:k,touchStart:c,touchEnd:E}},qe=()=>{const[r,t]=a.useState(!1),[s,u]=a.useState(""),[m,f]=a.useState(!1),{user:l,isAuthenticated:g,logout:y}=Me(),{toggleDarkMode:p,isDark:h,showNotification:d}=q(),{isOnline:n}=Be(),o=Se(),c=Ee(),j=a.useRef(null),E=a.useRef(null);a.useEffect(()=>{t(!1)},[o]),a.useEffect(()=>{const b=i=>{E.current&&!E.current.contains(i.target)&&t(!1)};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]),a.useEffect(()=>{m&&j.current&&j.current.focus()},[m]);const R=b=>{b.preventDefault(),s.trim()&&(c(`/search?q=${encodeURIComponent(s.trim())}`),u(""),f(!1))},$=async()=>{try{await y(),d({type:"success",title:"Logged out",message:"You have been successfully logged out.",duration:3e3}),c("/")}catch(b){d({type:"error",title:"Logout failed",message:b.message||"Failed to logout",duration:5e3})}},{bindGestures:C}=Ve({onSwipeDown:()=>{r||t(!0)},onSwipeUp:()=>{r&&t(!1)}}),k=({to:b,children:i,mobile:x=!1})=>e.jsx(P,{to:b,className:`
        ${x?"block px-3 py-2 rounded-md text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200":"text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200"}
        ${o.pathname===b?"bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300":""}
      `,onClick:()=>t(!1),children:i});return e.jsx("nav",{className:"fixed top-0 left-0 right-0 bg-white dark:bg-gray-900 shadow-sm border-b border-gray-200 dark:border-gray-700 z-40",role:"navigation","aria-label":"Main navigation",...C(),children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{to:"/",className:"flex-shrink-0 flex items-center","aria-label":"Underground Voices home",children:e.jsx("span",{className:"text-xl font-bold text-primary-600 dark:text-primary-400",children:"ðŸ“° Underground Voices"})}),e.jsxs("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[e.jsx(k,{to:"/",children:"Home"}),g&&e.jsx(k,{to:"/dashboard",children:"Dashboard"}),e.jsx(k,{to:"/search",children:"Search"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${n?"bg-green-500":"bg-red-500"}`,title:n?"Online":"Offline","aria-label":n?"Currently online":"Currently offline"}),e.jsx("button",{onClick:()=>f(!m),className:"p-2 rounded-md text-gray-400 dark:text-gray-500 hover:text-gray-500 dark:hover:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500","aria-label":"Toggle search",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("button",{onClick:p,className:"p-2 rounded-md text-gray-400 dark:text-gray-500 hover:text-gray-500 dark:hover:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500","aria-label":h?"Switch to light mode":"Switch to dark mode",children:h?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),g?e.jsxs("div",{className:"relative",ref:E,children:[e.jsxs("button",{onClick:()=>t(!r),className:"flex items-center space-x-2 p-2 rounded-md text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500","aria-label":"User menu","aria-expanded":r,children:[e.jsx("div",{className:"w-6 h-6 bg-primary-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:l?.username?.[0]?.toUpperCase()||"U"}),e.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg py-1 ring-1 ring-black ring-opacity-5 focus:outline-none",children:[e.jsxs("div",{className:"px-4 py-2 text-sm text-gray-700 dark:text-gray-300 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"font-medium",children:l?.displayName||l?.username}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:l?.email})]}),e.jsx(P,{to:"/dashboard",className:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",onClick:()=>t(!1),children:"Dashboard"}),e.jsx(P,{to:"/settings",className:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",onClick:()=>t(!1),children:"Settings"}),e.jsx("button",{onClick:$,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:"Sign Out"})]})]}):e.jsxs("div",{className:"hidden sm:flex sm:items-center sm:space-x-2",children:[e.jsx(P,{to:"/login",className:"text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200",children:"Sign In"}),e.jsx(P,{to:"/register",className:"bg-primary-600 hover:bg-primary-700 text-white px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:"Sign Up"})]}),e.jsx("button",{onClick:()=>t(!r),className:"sm:hidden p-2 rounded-md text-gray-400 dark:text-gray-500 hover:text-gray-500 dark:hover:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500","aria-label":"Toggle mobile menu","aria-expanded":r,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),m&&e.jsx("div",{className:"pb-4",children:e.jsx("form",{onSubmit:R,className:"max-w-md mx-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:j,type:"text",value:s,onChange:b=>u(b.target.value),placeholder:"Search articles, topics, or authors...",className:"w-full pl-4 pr-10 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400","aria-label":"Search"}),e.jsx("button",{type:"submit",className:"absolute inset-y-0 right-0 flex items-center pr-3","aria-label":"Submit search",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})})}),r&&e.jsx("div",{className:"sm:hidden",children:e.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(k,{to:"/",mobile:!0,children:"Home"}),g&&e.jsx(k,{to:"/dashboard",mobile:!0,children:"Dashboard"}),e.jsx(k,{to:"/search",mobile:!0,children:"Search"}),!g&&e.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(k,{to:"/login",mobile:!0,children:"Sign In"}),e.jsx(k,{to:"/register",mobile:!0,children:"Sign Up"})]})]})})]})})},Je=()=>{const{notifications:r,dismissNotification:t}=q();return r.length===0?null:e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2",children:r.map(s=>e.jsx(We,{notification:s,onDismiss:t},s.id))})},We=({notification:r,onDismiss:t})=>{const{id:s,type:u,title:m,message:f,duration:l}=r;a.useEffect(()=>{if(l>0){const p=setTimeout(()=>{t(s)},l);return()=>clearTimeout(p)}},[s,l,t]);const y=(()=>{switch(u){case"success":return{bg:"bg-green-50 dark:bg-green-900",border:"border-green-200 dark:border-green-700",icon:"âœ…",iconColor:"text-green-600 dark:text-green-400"};case"error":return{bg:"bg-red-50 dark:bg-red-900",border:"border-red-200 dark:border-red-700",icon:"âŒ",iconColor:"text-red-600 dark:text-red-400"};case"warning":return{bg:"bg-yellow-50 dark:bg-yellow-900",border:"border-yellow-200 dark:border-yellow-700",icon:"âš ï¸",iconColor:"text-yellow-600 dark:text-yellow-400"};case"info":default:return{bg:"bg-blue-50 dark:bg-blue-900",border:"border-blue-200 dark:border-blue-700",icon:"â„¹ï¸",iconColor:"text-blue-600 dark:text-blue-400"}}})();return e.jsx("div",{className:`
        max-w-sm w-full ${y.bg} border ${y.border} rounded-lg shadow-lg
        transform transition-all duration-300 ease-in-out animate-slide-up
      `,role:"alert","aria-live":"polite",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:`flex-shrink-0 ${y.iconColor} text-lg mr-3 mt-0.5`,children:y.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[m&&e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:m}),f&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:f})]}),e.jsx("button",{onClick:()=>t(s),className:"ml-3 flex-shrink-0 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 rounded-md p-1","aria-label":"Dismiss notification",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l>0&&e.jsx("div",{className:"mt-3 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ease-linear ${u==="success"?"bg-green-500":u==="error"?"bg-red-500":u==="warning"?"bg-yellow-500":"bg-blue-500"}`,style:{width:"100%",animation:`shrink ${l}ms linear forwards`}})})]})})},fe=document.createElement("style");fe.textContent=`
  @keyframes shrink {
    from { width: 100%; }
    to { width: 0%; }
  }
`;document.head.appendChild(fe);const Qe=a.lazy(()=>N(()=>import("./Home-MP8PpCB4.js"),__vite__mapDeps([0,1,2,3,4]))),Xe=a.lazy(()=>N(()=>import("./Dashboard-z0ZuedNL.js"),__vite__mapDeps([5,1,2,3,4]))),Ke=a.lazy(()=>N(()=>import("./Login-Bx4Wb436.js"),__vite__mapDeps([6,1,2,3,4]))),Ze=a.lazy(()=>N(()=>import("./Register-Ce5g9_Q7.js"),__vite__mapDeps([7,1,2,3,4]))),ne=a.lazy(()=>N(()=>import("./ArticleEditor-CjOdjdAY.js"),__vite__mapDeps([8,1,2,3,4]))),er=a.lazy(()=>N(()=>import("./ArticleView-NeVrQqMQ.js"),__vite__mapDeps([9,1,2,3,4]))),ae=a.lazy(()=>N(()=>import("./StoryboardEditor-DgI8Zv33.js"),__vite__mapDeps([10,1,11,3,4]))),rr=a.lazy(()=>N(()=>import("./StoryboardView-CwGzRj_i.js"),__vite__mapDeps([12,1,2,11,3,4]))),tr=a.lazy(()=>N(()=>import("./Profile-CgQrHs1-.js"),__vite__mapDeps([13,1,3,4]))),sr=a.lazy(()=>N(()=>import("./Settings-BiHsQr2e.js"),__vite__mapDeps([14,1,2,3,4]))),or=a.lazy(()=>N(()=>import("./Search-Dd4jF2qq.js"),__vite__mapDeps([15,1,2,3,4]))),D=({children:r})=>localStorage.getItem("accessToken")?r:e.jsx(ve,{to:"/login",replace:!0});function nr(){return e.jsx(He,{children:e.jsx(be,{children:e.jsx(ze,{children:e.jsx(Le,{children:e.jsx($e,{children:e.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-900 transition-colors duration-300",children:[e.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-primary-600 text-white p-2 rounded-md z-50",children:"Skip to main content"}),e.jsx(qe,{}),e.jsx("main",{id:"main-content",className:"relative min-h-screen pt-16",role:"main",children:e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(Ye,{size:"large"})}),children:e.jsxs(ke,{children:[e.jsx(w,{path:"/",element:e.jsx(Qe,{})}),e.jsx(w,{path:"/login",element:e.jsx(Ke,{})}),e.jsx(w,{path:"/register",element:e.jsx(Ze,{})}),e.jsx(w,{path:"/search",element:e.jsx(or,{})}),e.jsx(w,{path:"/article/:id",element:e.jsx(er,{})}),e.jsx(w,{path:"/storyboard/:id",element:e.jsx(rr,{})}),e.jsx(w,{path:"/profile/:username",element:e.jsx(tr,{})}),e.jsx(w,{path:"/dashboard",element:e.jsx(D,{children:e.jsx(Xe,{})})}),e.jsx(w,{path:"/article/new",element:e.jsx(D,{children:e.jsx(ne,{})})}),e.jsx(w,{path:"/article/:id/edit",element:e.jsx(D,{children:e.jsx(ne,{})})}),e.jsx(w,{path:"/storyboard/new",element:e.jsx(D,{children:e.jsx(ae,{})})}),e.jsx(w,{path:"/storyboard/:id/edit",element:e.jsx(D,{children:e.jsx(ae,{})})}),e.jsx(w,{path:"/settings",element:e.jsx(D,{children:e.jsx(sr,{})})}),e.jsx(w,{path:"*",element:e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen p-6 text-center",children:e.jsxs("div",{className:"max-w-md",children:[e.jsx("div",{className:"text-6xl mb-4",role:"img","aria-label":"Not found",children:"ðŸ“°"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Story Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"The page you're looking for doesn't exist or has been moved."}),e.jsx("button",{onClick:()=>window.history.back(),className:"bg-primary-600 hover:bg-primary-700 text-white px-6 py-2 rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:"Go Back"})]})})})]})})}),e.jsx(Je,{})]})})})})})})}const ar=()=>{const r=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;r==="dark"||!r&&t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")};ar();window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",r=>{localStorage.getItem("theme")||(r.matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"))});const ir=new PerformanceObserver(r=>{for(const t of r.getEntries())t.entryType==="navigation"&&t.loadEventEnd-t.loadEventStart>3e3&&console.warn("Slow page load detected:",t.loadEventEnd-t.loadEventStart+"ms")});typeof PerformanceObserver<"u"&&ir.observe({entryTypes:["navigation"]});Re.createRoot(document.getElementById("root")).render(e.jsx(ce.StrictMode,{children:e.jsx(nr,{})}));export{Ye as L,q as a,Ve as b,Me as c,Be as d,e as j,Oe as u};

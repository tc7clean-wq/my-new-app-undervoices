import{d as a}from"./vendor-DZhegkiK.js";import{a as C}from"./index-Dc-RHZ8Q.js";const T=()=>{const[u,d]=a.useState(!1),[h,f]=a.useState(!1),[m,S]=a.useState(""),[b,y]=a.useState(0),{userPreferences:s,announceToScreenReader:o}=C(),r=a.useRef(null);a.useEffect(()=>{const n=window.SpeechRecognition||window.webkitSpeechRecognition;return f(!!n),n&&(r.current=new n,r.current.continuous=!1,r.current.interimResults=!0,r.current.lang=s.language||"en-US",r.current.maxAlternatives=1,r.current.onstart=()=>{d(!0),o("Voice input started")},r.current.onend=()=>{d(!1),o("Voice input ended")},r.current.onresult=e=>{let t="",l="";for(let c=e.resultIndex;c<e.results.length;c++){const i=e.results[c];i.isFinal?(t+=i[0].transcript,y(i[0].confidence)):l+=i[0].transcript}S(t||l)},r.current.onerror=e=>{console.error("Speech recognition error:",e.error),d(!1);let t="Voice input error";switch(e.error){case"no-speech":t="No speech detected";break;case"audio-capture":t="Microphone access denied";break;case"not-allowed":t="Speech recognition not allowed";break;case"network":t="Network error during speech recognition";break;default:t=`Speech recognition error: ${e.error}`}o(t)}),()=>{r.current&&r.current.abort()}},[s.language,o]);const w=a.useCallback(()=>{if(!h||!s.enableVoiceHints)return!1;try{if(r.current&&!u)return r.current.start(),!0}catch(n){console.error("Error starting speech recognition:",n),o("Failed to start voice input")}return!1},[h,s.enableVoiceHints,u,o]),k=a.useCallback(()=>{r.current&&u&&r.current.stop()},[u]),p=a.useCallback((n,e={})=>{if(!("speechSynthesis"in window)||!s.enableVoiceHints)return;speechSynthesis.cancel();const t=new SpeechSynthesisUtterance(n);t.lang=e.lang||s.language||"en-US",t.rate=e.rate||1,t.pitch=e.pitch||1,t.volume=e.volume||.8;const l=speechSynthesis.getVoices(),c=l.find(i=>i.lang.startsWith(t.lang))||l[0];c&&(t.voice=c),speechSynthesis.speak(t)},[s.enableVoiceHints,s.language]),v=a.useCallback(n=>{const e=n.toLowerCase().trim();if(e.includes("go to")||e.includes("navigate to")){if(e.includes("home")||e.includes("homepage"))return{action:"navigate",target:"/"};if(e.includes("dashboard"))return{action:"navigate",target:"/dashboard"};if(e.includes("settings"))return{action:"navigate",target:"/settings"};if(e.includes("search"))return{action:"navigate",target:"/search"}}if(e.includes("create")||e.includes("new")){if(e.includes("article")||e.includes("story"))return{action:"create",target:"article"};if(e.includes("storyboard")||e.includes("map"))return{action:"create",target:"storyboard"}}return e.includes("search for")?{action:"search",query:e.replace(/.*search for\s+/,"")}:e.includes("dark mode")||e.includes("dark theme")?{action:"theme",target:"dark"}:e.includes("light mode")||e.includes("light theme")?{action:"theme",target:"light"}:e.includes("help")||e.includes("what can")?{action:"help"}:{action:"unknown",command:e}},[]),g=a.useCallback(n=>{const e=[];switch(n){case"homepage":e.push('Say "search for" followed by a topic to search articles'),e.push('Say "create new article" to start writing'),e.push('Say "go to dashboard" to access your content');break;case"dashboard":e.push('Say "create new article" to write a story'),e.push('Say "create new storyboard" to map connections'),e.push('Say "go to settings" to change preferences');break;case"article-editor":e.push('Say "save article" to save your work'),e.push('Say "preview" to see how it looks'),e.push('Say "publish" to make it live');break;case"storyboard":e.push('Say "add node" to create a new connection point'),e.push('Say "connect nodes" to link ideas'),e.push('Say "save storyboard" to save your map');break;default:e.push('Say "help" to learn about voice commands'),e.push('Say "go to" followed by a page name to navigate'),e.push('Say "dark mode" or "light mode" to change theme')}return e},[]),V=a.useCallback(n=>{const t=`Voice commands available: ${g(n).join(". ")}`;p(t,{rate:.9})},[g,p]);return{isSupported:h,isListening:u,transcript:m,confidence:b,startListening:w,stopListening:k,speak:p,processVoiceCommand:v,getVoiceHints:g,announceHints:V}};export{T as u};
